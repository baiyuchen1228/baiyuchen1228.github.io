<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>實驗五: 歐姆定律及電容實驗</title>
    <link rel="stylesheet" href="css/exp5.css">
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/jquery.bgiframe.js"></script>
    <link rel="stylesheet" href="css/jquery-ui.css"/>
</head>

<body>
    <h1>
        <a href="../canvas.html" target="_self">國立中正大學普通物理實驗學習平台</a>
        <span class="main-menu" onclick="switchMenu( this, 'SubMenu1' )">實驗 <span style="font-size:9px;">&#9660;</span>
            <ul id="SubMenu1" class="sub-menu" style="display:none;">
                <li><a href="exp3.html" target="_self">實驗三：等電位實驗</a></li>
                <li><a href="exp5.html" target="_self">實驗五: 歐姆定律及電容實驗</a></li>
                <li><a href="exp6.html" target="_self">實驗六: 克希荷夫</a></li>
                <li><a href="exp2.html" target="_self">實驗二: 示波器與波形產生器教學</a></li>
                <li><a href="exp7.html" target="_self">實驗七: RC直流電路</a></li>
                <li><a href="exp8.html" target="_self">實驗八: 磁力實驗</a></li>
                <li><a href="exp10.html" target="_self">實驗十: RLC直流電路</a></li>
                <li><a href="exp11.html" target="_self">實驗十一: RLC交流電路</a></li>
            </ul>
        </span>
    </h1>
    <h2>
        我的課程 / 普通物理實驗 / 實驗五: 歐姆定律及電容實驗
    </h2>
    
    <!-- <img id="breadboard" class="breadboard-icon" title="breadboard" src="../images/breadboard.png" alt="" width="500px"
        style="position:absolute; top:300px; left: 550px;"> -->
    <!-- <img id="resistance" class="resistance-icon" title="20k-resistance" src="../images/resistance.png" alt=""
        width="140px" style="position:absolute; top:446px; left: 610px;z-index: 2;"> -->
    
    <div id="container" style="position: absolute; left: 0px; top: 150px; z-index: 0; height: 600px;">
        <div id="powersupply">
            <p id="powersupply1" class="powersupply-text"></p>
            <p id="powersupply2" class="powersupply-text"></p>
            <p id="powersupply3" class="powersupply-text"></p>
            <p id="powersupply4" class="powersupply-text"></p>
            <button type="button" id="powersupply5" class="powersupply-button">＋</button>
            <button type="button" id="powersupply6" class="powersupply-button">－</button>
            <button type="button" id="powersupply7" class="powersupply-button">＋</button>
            <button type="button" id="powersupply8" class="powersupply-button">－</button>
            <button type="button" id="powersupply9" class="powersupply-button">＋</button>
            <button type="button" id="powersupply10" class="powersupply-button">－</button>
            <button type="button" id="powersupply11" class="powersupply-button">＋</button>
            <button type="button" id="powersupply12" class="powersupply-button">－</button>
            <button type="button" id="powersupply13" class="powersupply-button">output</button>
            <button type="button" id="powersupply14" class="powersupply-button">power</button>
        </div>
        <div id="multimeter1">
            <p id="multimeter1_3" class="multimeter-title">1.23</p>
            <button type="button" id="multimeter1_1" class="multimeter-button">－＞</button>
            <button type="button" id="multimeter1_2" class="multimeter-button">＜－</button>
        </div>
        <div id="multimeter2">
            <p id="multimeter2_3" class="multimeter-title">1.23</p>
            <button type="button" id="multimeter2_1" class="multimeter-button">－＞</button>
            <button type="button" id="multimeter2_2" class="multimeter-button">＜－</button>
        </div>
        <canvas id="myCanvas" width="500" height="180" style="position: relative; left: 550px; top: 150px; z-index: 0; float: left;" ></canvas>
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="500px" height="180px" style="left: 550px; top: 150px; z-index:0; position:absolute" id="svgline"></svg>
    
    </div>
    <button type="button" class="buttonInactive" id="addWire" href="#" onclick="toggleWireButton()">Add Wire</button>
    <button type="button" class="buttonInactive" id="addResistance" href="#" onclick="toggleResistanceButton()">Add Resistor</button>
    <button type="button" class="buttonInactive" id="addInductance" href="#" onclick="toggleInductanceButton()">Add Inductor</button>
    <button type="button" class="buttonInactive" id="del" href="#" onclick="toggleDelButton()">Delete Mode</button>
    <script type="text/javascript">
        var finalOutput;
        var drawWire=0;
        var wireInitial;
        var drawResistance=0;
        var resistanceInitial;
        var drawLED=0;
        var LEDInitial;
        var drawInductance=0;
        var inductanceInitial;

        var chipNo=1;
        var wireNo=1;
        var resistanceNo=1;
        var inductanceNo=1;
        var LEDNo=1;
        var deletemode=0;
        var delIni;
        

        function approx_x(x){
            return (Math.floor(x/10)*10+5) ;
        }

        $("#container").mousedown(function(e){
            if(drawWire==1)
            {
                wireInitial=e;
            }
            if(drawResistance==1)
            {
                resistanceInitial=e;
            }
            if(drawInductance==1)
            {
                inductanceInitial=e;
            }
            if(drawLED==1)
            {
                LEDInitial=e;
            }
            if(deletemode==1)
            {
                delIni=e;
            }
        });

        function parseSVG(s) {
            var div= document.createElementNS('http://www.w3.org/1999/xhtml', 'div');
            div.innerHTML= '<svg xmlns="http://www.w3.org/2000/svg">'+s+'</svg>';
            var frag= document.createDocumentFragment();
            while (div.firstChild.firstChild)
                frag.appendChild(div.firstChild.firstChild);
            return frag;
        }

        $("#container").mouseup(function(e){
            if(drawWire==1)
            {
                var wireFinal=e;

                x1=approx_x(wireInitial.pageX);
                y1=approx_x(wireInitial.pageY);
                x2=approx_x(wireFinal.pageX);
                y2=approx_x(wireFinal.pageY);
                x1-=550;
                x2-=550;
                y1-=300;
                y2-=300;
                if(x1==x2 && y1==y2)
                {
                    alert("It is meaningless to insert both the ends of wire to the same point.");
                    return;
                }
                document.getElementById('svgline').appendChild(parseSVG('<line id=wire'+wireNo+' x1='+x1+' y1='+y1+' x2='+x2+' y2='+y2+' style="stroke:rgb(255,0,0);stroke-width:2"/>'));
                wireNo++;
                
            }
            if(drawResistance==1)
            {
                var resistanceFinal=e;
                
                x1=approx_x(resistanceInitial.pageX);
                y1=approx_x(resistanceInitial.pageY);
                x2=approx_x(resistanceFinal.pageX);
                y2=approx_x(resistanceFinal.pageY);
                x1-=550;
                x2-=550;
                y1-=300;
                y2-=300;
                if(x1==x2 && y1==y2)
                {
                    alert("Can't insert both the legs of resistor to the same point.");
                    return;
                }
                var ohms=prompt("Enter the value of Resistance in ohms","Resistance in Ohms");
                ohms=parseFloat(ohms);
                if(isNaN(ohms) || ohms=='' || ohms<=0)
                {
                    alert("Invalid value of resistance!");
                    return;
                }
                document.getElementById('svgline').appendChild(parseSVG('<line dataohm="'+ohms+'"id=resistance'+resistanceNo+' x1='+x1+' y1='+y1+' x2='+x2+' y2='+y2+' style="stroke:rgb(0,255,0);stroke-width:2"/>'));
                //to draw the box of the resistor
                var centerX=x1-(x1-x2)/2;
                var centerY=y1-(y1-y2)/2;
                var slope=Math.atan((y2-y1)/(x2-x1));
                var rectX1=centerX-5*Math.sin(slope)+10*Math.cos(slope);
                var rectY1=centerY+5*Math.cos(slope)+10*Math.sin(slope);
                var rectX2=centerX+10*Math.cos(slope)+5*Math.sin(slope);
                var rectY2=centerY+10*Math.sin(slope)-5*Math.cos(slope);
                var rectX3=centerX+5*Math.sin(slope)-10*Math.cos(slope);
                var rectY3=centerY-5*Math.cos(slope)-10*Math.sin(slope);
                var rectX4=centerX-10*Math.cos(slope)-5*Math.sin(slope);
                var rectY4=centerY-10*Math.sin(slope)+5*Math.cos(slope);
                document.getElementById('svgline').appendChild(parseSVG('<polygon id=resistanceBox'+resistanceNo+' points="'+rectX1+','+rectY1+' '+rectX2+','+rectY2+' '+rectX3+','+rectY3+' '+rectX4+','+rectY4+'" style="fill:blue; stroke:lime; stroke-width:1"/>'));    
                resistanceNo++;
            }
            if(drawInductance==1)
            {
                var inductanceFinal=e;
                
                x1=approx_x(inductanceInitial.pageX);
                y1=approx_x(inductanceInitial.pageY);
                x2=approx_x(inductanceFinal.pageX);
                y2=approx_x(inductanceFinal.pageY);
                x1-=550;
                x2-=550;
                y1-=300;
                y2-=300;
                if(x1==x2 && y1==y2)
                {
                    alert("Can't insert both the legs of inductor to the same point.");
                    return;
                }
                var mhos=prompt("Enter the value of Inductance in mhos","Inductance in Ohms");
                mhos=parseFloat(mhos);
                if(isNaN(mhos) || mhos=='' || mhos<=0)
                {
                    alert("Invalid value of inductance!");
                    return;
                }
                document.getElementById('svgline').appendChild(parseSVG('<line datamho="'+mhos+'"id=inductance'+inductanceNo+' x1='+x1+' y1='+y1+' x2='+x2+' y2='+y2+' style="stroke:rgb(139,0,139);stroke-width:2"/>'));
                //to draw the box of the resistor
                var centerX=x1-(x1-x2)/2;
                var centerY=y1-(y1-y2)/2;
                var slope=Math.atan((y2-y1)/(x2-x1));
                var rectX1=centerX-5*Math.sin(slope)+10*Math.cos(slope);
                var rectY1=centerY+5*Math.cos(slope)+10*Math.sin(slope);
                var rectX2=centerX+10*Math.cos(slope)+5*Math.sin(slope);
                var rectY2=centerY+10*Math.sin(slope)-5*Math.cos(slope);
                var rectX3=centerX+5*Math.sin(slope)-10*Math.cos(slope);
                var rectY3=centerY-5*Math.cos(slope)-10*Math.sin(slope);
                var rectX4=centerX-10*Math.cos(slope)-5*Math.sin(slope);
                var rectY4=centerY-10*Math.sin(slope)+5*Math.cos(slope);
                document.getElementById('svgline').appendChild(parseSVG('<polygon id=inductanceBox'+inductanceNo+' points="'+rectX1+','+rectY1+' '+rectX2+','+rectY2+' '+rectX3+','+rectY3+' '+rectX4+','+rectY4+'" style="fill:rgb(255,215,0); stroke:black; stroke-width:1"/>'));    
                inductanceNo++;
            }
            if(deletemode==1)
            {
                console.log(delIni);
                
                var delFin=e;
                    console.log(delFin);
                x1=approx_x(delIni.pageX);
                y1=approx_x(delIni.pageY);
                x2=approx_x(delFin.pageX);
                y2=approx_x(delFin.pageY);
                x1-=550;
                x2-=550;
                y1-=300;
                y2-=300;
                var id;
                Things=$("line");
                for (var i = Things.length - 1; i >= 0; i--) {
                    if(Things[i].x1.baseVal.value==x1)
                    {
                        if(Things[i].y1.baseVal.value==y1 && Things[i].x2.baseVal.value==x2 && Things[i].y2.baseVal.value==y2)
                        {
                            console.log(Things[i].id[0]);
                            if(Things[i].id[0]=="w"){
                                    $("#"+Things[i].id).remove();
                            }
                            
                            if(Things[i].id[0]=="r")
                            {
                                
                                $("#resistanceBox"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }
                            if(Things[i].id[0]=="i")
                            {
                                
                                $("#inductanceBox"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }
                            if(Things[i].id[0]=="L")
                            {
                                
                                $("#LEdcircle"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }

                            return;
                        }
                    }
                    if(Things[i].x2.baseVal.value==x1)
                    {
                        if(Things[i].y2.baseVal.value==y1 && Things[i].x1.baseVal.value==x2 && Things[i].y1.baseVal.value==y2)
                        {
                            console.log(Things[i].id[0]);
                            if(Things[i].id[0]=="w"){
                                    $("#"+Things[i].id).remove();
                            }
                            if(Things[i].id[0]=="r")
                            {
                                
                                $("#resistanceBox"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }
                            if(Things[i].id[0]=="i")
                            {
                                
                                $("#inductanceBox"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }
                            if(Things[i].id[0]=="L")
                            {
                                //  console.log("#LEdcircle"+Things[i].id[Things[i].id.length -1]);
                                $("#LEdcircle"+Things[i].id[Things[i].id.length -1]).remove();
                                $("#"+Things[i].id).remove();

                            }
                            return;
                        }
                    }
                };
            }
        });
        $(document).ready(function() {

            var canvas = $("#myCanvas");
            var context = canvas.get(0).getContext("2d");
            var current_x=0;
            context.strokeStyle = "rgb(208, 208, 208)";
            context.fillStyle = "rgb(88, 88, 88)";
            for (var j = 0; j < 4; j++) {
                
                for (var i = 0; i < 5; i++) {
                    current_x= current_x+20;
                    context.fillRect(current_x,40, 10, 10);
                };
                current_x=current_x + 20;
            };
            current_x=0;
            for (var j = 0; j < 4; j++) {
                
                for (var i = 0; i < 5; i++) {
                    current_x= current_x+20;
                    context.fillRect(current_x,60, 10, 10);
                };
                current_x=current_x + 20;
            };
            current_x=0;
            context.lineWidth=3;
            context.beginPath(); // Start the path
            context.moveTo(0, 80); // Set the path origin
            context.lineTo(50*11-5, 80); // Set the path destination
            context.closePath(); // Close the path
            context.stroke(); // Outline the path

            for (var j = 0; j <5; j++) {
                
                for (var i = 0; i < 23; i++) {
                        current_x= current_x+20;
                        context.fillRect(current_x,90+20*j, 10, 10);
                    }; 
                current_x=0;

            };

            // context.lineWidth=5;
            // context.beginPath(); // Start the path
            // context.moveTo(90, 195); // Set the path origin
            // context.lineTo(50*11-5, 195); // Set the path destination
            // context.closePath(); // Close the path
            // context.stroke(); // Outline the path

            
            // context.fillStyle="rgb(88,88,88)";
            // for (var j = 0; j <5; j++) {
                
            //     for (var i = 0; i < 23; i++) {
            //             current_x= current_x+20;
            //             context.fillRect(current_x,210+20*j, 10, 10);
            //         }; 
            //     current_x=70;

            // };
            // current_x=70;
            // context.lineWidth=3;
            // context.beginPath(); // Start the path
            // context.moveTo(90, 310); // Set the path origin
            // context.lineTo(50*11-5, 310); // Set the path destination
            // context.closePath(); // Close the path
            // context.stroke(); // Outline the path
            
            // current_x=70;
            // for (var j = 0; j < 4; j++) {
                
            //     for (var i = 0; i < 5; i++) {
            //         current_x= current_x+20;
            //         context.fillRect(current_x,320, 10, 10);
            //     };
            //     current_x=current_x + 20;
            // };
            // current_x=70;
            
            // for (var j = 0; j < 4; j++) {
                
            //     for (var i = 0; i < 5; i++) {
            //         current_x= current_x+20;
            //         context.fillRect(current_x,340, 10, 10);
            //     };
            //     current_x=current_x + 20;
            // };
            

        });
        function toggleDelButton(){
            if(drawInductance==1)
            {
                $this=$("#addInductance");
                $this.css('background-color','white');
                drawInductance=0;
            }
            else if(drawResistance==1)
            {
                $this=$("#addResistance");
                $this.css('background-color','white');
                drawResistance=0;
            }
            else if(drawWire==1)
            {
                $this=$("#addWire");
                $this.css('background-color','white');
                drawWire=0;
            }
            $this=$("#del");
            if(deletemode==1)
            {
                $this.css('background-color','white');
                deletemode=0;

            }else
            {
                $this.css('background-color','red');
                deletemode=1;
            }
        }
                
        function toggleWireButton(){
            if(drawInductance==1)
            {
                $this=$("#addInductance");
                $this.css('background-color','white');
                drawInductance=0;
            }
            else if(drawResistance==1)
            {
                $this=$("#addResistance");
                $this.css('background-color','white');
                drawResistance=0;
            }
            else if(deletemode==1)
            {
                $this=$("#del");
                $this.css('background-color','white');
                deletemode=0;
            }
            $this=$("#addWire");
            if(drawWire==1)
            {
                $this.css('background-color','white');
                drawWire=0;
            }
            else
            {
                $this.css('background-color','red');
                drawWire=1;
            }
        };

        function toggleResistanceButton(){
            if(drawInductance==1)
            {
                $this=$("#addInductance");
                $this.css('background-color','white');
                drawInductance=0;
            }
            else if(deletemode==1)
            {
                $this=$("#del");
                $this.css('background-color','white');
                deletemode=0;
            }
            else if(drawWire==1)
            {
                $this=$("#addWire");
                $this.css('background-color','white');
                drawWire=0;
            }
            $this=$("#addResistance");
            if(drawResistance==1)
            {
                $this.css('background-color','white');
                drawResistance=0;
            }
            else
            {
                $this.css('background-color','red');
                drawResistance=1;
            }          
        };

        function toggleInductanceButton(){
            if(drawResistance==1)
            {
                $this=$("#addResistance");
                $this.css('background-color','white');
                drawResistance=0;
            }
            else if(deletemode==1)
            {
                $this=$("#del");
                $this.css('background-color','white');
                deletemode=0;
            }
            else if(drawWire==1)
            {
                $this=$("#addWire");
                $this.css('background-color','white');
                drawWire=0;
            }
            $this=$("#addInductance");
            if(drawInductance==1)
            {
                $this.css('background-color','white');
                drawInductance=0;
            }
            else
            {                
                $this.css('background-color','red');
                drawInductance=1;
            }
                
                    
        };
        
    </script>
    <!-- <script type="text/javascript">
    function move (target) {
        function moveTarget (e) {
            var intX = e.pageX;
            var intY = e.pageY;
            target.style.left = intX - (target.width)/2 + "px";
            target.style.top = intY - (target.height)/2 + "px";
        }
        return moveTarget;
    }
    document.getElementById("apple").onclick = function (e){
        if(!document.onmousemove)
            document.onmousemove = move(e.target);
        else
            document.onmousemove = null;
    }
    document.getElementById("banana").onclick = function (e){
        if(!document.onmousemove)
            document.onmousemove = move(e.target);
        else
            document.onmousemove = null;
    }
    </script> -->
    <script type="text/javascript" src="js\exp5.js"></script>
</body>

</html>